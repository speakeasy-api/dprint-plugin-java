# Cross-compilation configuration for wasm32-unknown-unknown.
#
# tree-sitter and tree-sitter-java compile C sources via the `cc` crate.
# For the wasm32-unknown-unknown target the `cc` crate needs a clang that
# can emit WebAssembly.  We supply that through a wrapper script that
# locates the wasi-sdk installation at build time.
#
# Prerequisites â€” install wasi-sdk (one-time):
#
#   mkdir -p ~/.local/wasi-sdk
#   curl -sL https://github.com/WebAssembly/wasi-sdk/releases/download/wasi-sdk-30/wasi-sdk-30.0-x86_64-linux.tar.gz \
#     | tar xz -C ~/.local/wasi-sdk --strip-components=1
#
# Then build:
#   cargo build --release --target=wasm32-unknown-unknown --features wasm

[env]
# Tell the `cc` crate to use our wrapper as the C compiler for wasm32.
# `relative = true` resolves the path relative to the workspace root.
# `force = false` means an explicit CC_wasm32_unknown_unknown in the
# environment will take precedence.
CC_wasm32_unknown_unknown = { value = "scripts/wasm32-clang.sh", relative = true, force = false }
AR_wasm32_unknown_unknown = { value = "scripts/wasm32-ar.sh", relative = true, force = false }

# Granary Task Reconciliation - PR #3837 Comparison

**Date:** 2026-02-15  
**Comparison Source:** PR #3837 `zSDKs/sdk-javav2` (473 files)  
**Match Rate:** 1% (7/473 files)

## Granary Status

**Total Tasks:** 34
- ✅ Done: 33
- ⏳ Todo: 1 (Task #32 - annotation brace spacing)

## Comparison Findings vs Granary Tasks

### ✅ RESOLVED: Tasks Already Done

| Finding | Files | Granary Task | Status |
|---------|-------|--------------|--------|
| Blank lines between members | 451 | Task #26 | ✅ Done |
| Modifier order (static final) | 5 | Task #27 | ✅ Done |
| Method chain wrapping | 50 | Task #28 | ✅ Done |
| Annotation placement | 1 | Task #29 | ✅ Done |
| Comment placement | 23 | Task #31 | ✅ Done |
| Import sorting/java.lang.* | 473 | Task #33 | ✅ Done |
| Trailing whitespace | 473 | Task #34 | ✅ Done |

### ⚠️ REMAINING GAPS: Not Covered by Granary Tasks

#### 1. Blank Line After Package Header (HIGH IMPACT)
**Finding:** 451 files affected  
**Issue:** Missing blank line after file header comment, before `package` statement

```diff
 /*
  * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
  */
+
 package org.openapis.review.openapi;
```

**Granary Task:** Task #26 addressed blank lines *between members*, but NOT the package header blank line  
**Action Needed:** New task or extend Task #26 scope

---

#### 2. Excess Blank Line After Imports (HIGH IMPACT)
**Finding:** 451 files affected  
**Issue:** Extra blank line after import block

```diff
 import org.openapis.review.openapi.utils.Utils;
 
-
 /**
  * SDK Review: A test document...
  */
```

**Granary Task:** Task #19 addressed blank lines "between imports", but not *after* imports block  
**Action Needed:** New task or extend Task #19 scope

---

#### 3. Argument List Wrapping (MEDIUM IMPACT)
**Finding:** 115 files affected  
**Issue:** PJF wraps more aggressively when arguments contain nested builders

```diff
 // Current (dprint)
-animal(Cat.builder().animalType(CatAnimalType.CAT).furLength("short").build())
+
+// Expected (PJF)
+animal(Cat.builder()
+        .animalType(CatAnimalType.CAT)
+        .furLength("short")
+        .build())
```

**Granary Task:** Task #30 "Improve argument list wrapping heuristics"  
**Status:** Marked ✅ Done, but comparison shows gap remains  
**Issue:** Task #30 may have addressed *some* arg wrapping, but not nested builder detection  
**Action Needed:** Reopen Task #30 or create Task #35 for nested builder wrapping in arglists

---

#### 4. Annotation Brace Spacing (LOW IMPACT)
**Finding:** 2 files affected  
**Issue:** `@Target({ElementType.FIELD})` formatting

**Granary Task:** Task #32 - already in "todo" status ✅  
**Action Needed:** None, already tracked

---

## Summary

### Tasks Validated ✅
- 7 tasks (26, 27, 28, 29, 31, 33, 34) are confirmed working by comparison

### Tasks Needing Follow-up ⚠️

1. **Task #26 (Blank lines between members)** - Scope incomplete
   - ✅ Works: Blank lines between class members
   - ❌ Missing: Blank line after package header comment
   - ❌ Missing: Remove excess blank line after imports

2. **Task #30 (Argument list wrapping)** - Marked done but gap remains
   - ✅ Works: Basic argument wrapping
   - ❌ Missing: Nested builder detection in arguments
   - Impact: 115 files (24%)

3. **Task #32 (Annotation brace spacing)** - Already todo ✅
   - Impact: 2 files (<1%)

### Recommended Actions

**Option A: Create New Tasks**
- Task #35: "Add blank line after package header and fix excess import blank line"
- Task #36: "Wrap nested builders in argument lists"

**Option B: Reopen/Extend Existing Tasks**
- Reopen Task #26, expand scope to include package header + import block
- Reopen Task #30, expand scope to include nested builder wrapping

**Option C: Accept Current State**
- Match rate is 1% now, would be ~70-80% if all gaps fixed
- Blank line issues are cosmetic (affects all files but low visual impact)
- Argument wrapping affects only test files (115 files, mostly test builders)

---

## Match Rate Projection

| Scenario | Match Rate | Files |
|----------|------------|-------|
| Current | 1% | 7/473 |
| + Fix package/import blank lines | ~50% | ~236/473 |
| + Fix nested builder arg wrapping | ~70-80% | ~350-380/473 |
| + Fix Task #32 (brace spacing) | ~70-80% | ~350-380/473 |

---

## Conclusion

The granary tasks captured most PJF parity gaps correctly, but:
1. **Task #26** scope was too narrow (member blank lines, not package/import)
2. **Task #30** was marked done prematurely (basic wrapping works, nested builders don't)
3. **Task #32** is correctly todo

The comparison validates that 7/34 tasks are production-ready, 2 tasks need rework, and 1 task is already tracked.
